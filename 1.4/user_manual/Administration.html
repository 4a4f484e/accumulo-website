<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/bootstrap-theme.min.css" rel="stylesheet">
<link href="/css/dataTables.bootstrap.css" rel="stylesheet">
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.dataTables.min.js"></script>
<script src="/js/dataTables.bootstrap.js"></script>
<link href="/css/accumulo.css" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<title>User Manual: Administration</title>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

if (ga.hasOwnProperty('loaded') && ga.loaded === true) {
  ga('create', 'UA-50934829-1', 'apache.org');
  ga('send', 'pageview');
}
</script>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-items">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/index.html">Accumulo</a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="nav navbar-nav">
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Project<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_index"><a href="/">Home</a></li>
          <li id="nav_downloads"><a href="/downloads/">Downloads</a></li>
          <li id="nav_features"><a href="/notable_features.html">Features</a></li>
          <li><a href="http://www.apache.org/licenses/LICENSE-2.0"><i class="fa fa-external-link"></i> License</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_getinvolved"><a href="/get_involved.html">Get Involved</a></li>
          <li id="nav_mailinglists"><a href="/mailing_list.html">Mailing Lists</a></li>
          <li id="nav_people"><a href="/people.html">People</a></li>
          <li id="nav_blog"><a href="https://blogs.apache.org/accumulo/">Blog</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Governance</li>
          <li id="nav_bylaws"><a href="/bylaws.html">Bylaws</a></li>
          <li id="nav_consensusbuilding"><a href="/governance/consensusBuilding.html">Consensus Building</a></li>
          <li id="nav_lazyconsensus"><a href="/governance/lazyConsensus.html">Lazy Consensus</a></li>
          <li id="nav_govreleasing"><a href="/governance/releasing.html">Releasing</a></li>
          <li id="nav_voting"><a href="/governance/voting.html">Voting</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Development<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_source"><a href="/source.html">Source &amp; Guide</a></li>
          <li id="nav_git"><a href="/git.html">Git Workflow</a></li>
          <li id="nav_versioning"><a href="/versioning.html">Versioning</a></li>
          <li id="nav_contrib"><a href="/contrib.html">Contrib Projects</a></li>
          <li id="nav_rb"><a href="/rb.html">Review Board</a></li>
          <li id="nav_releasing"><a href="/releasing.html">Making Releases</a></li>
          <li id="nav_verify_release"><a href="/verifying_releases.html">Verifying Releases</a></li>
          <li><a href="https://issues.apache.org/jira/browse/accumulo"><i class="fa fa-external-link"></i> Issues</a></li>
          <li><a href="https://builds.apache.org/view/A-D/view/Accumulo/"><i class="fa fa-external-link"></i> Builds</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Manual</li>
          <li><a href="/1.6/accumulo_user_manual.html">1.6</a></li>
          <li><a href="/1.7/accumulo_user_manual.html">1.7</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Javadoc</li>
          <li><a href="/1.6/apidocs">1.6</a></li>
          <li><a href="/1.7/apidocs">1.7</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Examples</li>
          <li id="nav_examples_1_6"><a href="/1.6/examples">1.6</a></li>
          <li id="nav_examples_1_7"><a href="/1.7/examples">1.7</a></li>
          <li class="divider"></li>
          <li id="old_documentation"><a href="/old_documentation.html">Docs for Older Verisons</a></li>
          <li id="nav_screenshots"><a href="/screenshots.html">Screenshots</a></li>
          <li id="nav_papers"><a href="/papers.html">Papers &amp; Other Links</a></li>
          <li id="nav_glossary"><a href="/glossary.html">Glossary</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Release Notes<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/release_notes/1.7.1.html">1.7.1</a></li>
          <li><a href="/release_notes/1.6.5.html">1.6.5</a></li>
          <li class="divider"></li>
          <li><a href="/release_notes/">Archives</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Other<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="/papers.html">Papers &amp; Presentations</a></li>
            <li><a href="/projects.html">Community Projects</a></li>
          </ul>
          </li>
          <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">ASF Links<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="http://www.apache.org"><i class="fa fa-external-link"></i> Apache Software Foundation</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html"><i class="fa fa-external-link"></i> Sponsorship</a></li>
            <li><a href="http://www.apache.org/security/"><i class="fa fa-external-link"></i> Security</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html"><i class="fa fa-external-link"></i> Thanks</a></li>
            <li><a href="http://www.apache.org/foundation/policies/conduct.html"><i class="fa fa-external-link"></i> Code of Conduct</a></li>
          </ul>
          </li>
        </ul>
        <form method="GET" action="http://search-hadoop.com/" class="navbar-form navbar-right" role="search">
          <div class="form-group">
            <input type="text" name="q" class="form-control" placeholder="Search"/>
            <input type="hidden" name="fc_project" value="Accumulo"/>
          </div>
          <button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
        </form>
      </div>
    </div>
  </nav>


<div class="container-fluid">
  <div class="row">
    <div class="col-md-2" id="sidebar">
      <div style="text-align: center">
        <a href="/"><img id="logo" alt="Apache Accumulo &trade;" class="img-responsive" src="/images/accumulo-logo.png"/></a>
        <br />
        Latest 1.7 release: <strong>1.7.1</strong><br />
        Latest 1.6 release: <strong>1.6.5</strong><br />
        <br>
        <a id="download-button-sidebar" class="btn btn-success btn-block" href="/downloads/" role="button">Download</a>
      </div>
      <hr>
      <table class="table" id="sociallinks">
        <tr><td><img src="/images/Twitter_logo_blue.png" style="height: 1em"></td><td><a href="https://twitter.com/apacheaccumulo">@ApacheAccumulo</a></td></tr>
        <tr><td><img src="/images/InBug-16px_0.png"></td><td><a href="https://www.linkedin.com/groups/Apache-Accumulo-Professionals-4554913">Apache Accumulo Professionals</a></td></tr>
        <tr><td><img src="/images/GitHub-Mark-32px.png" style="height: 1em"></td><td><a href="https://github.com/apache/accumulo">apache / accumulo</a></td></tr>
        <tr><td><span class="glyphicon glyphicon-comment"></span></td><td><a href="irc://chat.freenode.net/accumulo">#accumulo @ freenode</a></td></tr>
        <tr><td><img src="/favicon.png" width="16" /></td><td><a href="http://blogs.apache.org/accumulo">Apache Accumulo Blog</a></td></tr>
      </table>
      <hr>
      <a id="accumulo-summit-logo" href="http://accumulosummit.com/"><img alt="Accumulo Summit" class="img-responsive" src="/images/accumulo-summit.png"></a>
    </div>
    <div class="col-md-8 col-md-offset-1">

      <div id="content">
        
        <h1 class="title">User Manual: Administration</h1>
        
        <p>** Next:** <a href="Shell_Commands.html">Shell Commands</a> ** Up:** <a href="accumulo_user_manual.html">Apache Accumulo User Manual Version 1.4</a> ** Previous:** <a href="Security.html">Security</a>   ** <a href="Contents.html">Contents</a>**</p>

<p><a id="CHILD_LINKS"></a><strong>Subsections</strong></p>

<ul>
  <li><a href="Administration.html#Hardware">Hardware</a></li>
  <li><a href="Administration.html#Network">Network</a></li>
  <li><a href="Administration.html#Installation">Installation</a></li>
  <li><a href="Administration.html#Dependencies">Dependencies</a></li>
  <li><a href="Administration.html#Configuration">Configuration</a></li>
  <li><a href="Administration.html#Initialization">Initialization</a></li>
  <li><a href="Administration.html#Running">Running</a></li>
  <li><a href="Administration.html#Monitoring">Monitoring</a></li>
  <li><a href="Administration.html#Logging">Logging</a></li>
  <li><a href="Administration.html#Recovery">Recovery</a></li>
</ul>

<hr />

<h2 id="a-idadministrationa-administration"><a id="Administration"></a> Administration</h2>

<h2 id="a-idhardwarea-hardware"><a id="Hardware"></a> Hardware</h2>

<p>Because we are running essentially two or three systems simultaneously layered across the cluster: HDFS, Accumulo and MapReduce, it is typical for hardware to consist of 4 to 8 cores, and 8 to 32 GB RAM. This is so each running process can have at least one core and 2 - 4 GB each.</p>

<p>One core running HDFS can typically keep 2 to 4 disks busy, so each machine may typically have as little as 2 x 300GB disks and as much as 4 x 1TB or 2TB disks.</p>

<p>It is possible to do with less than this, such as with 1u servers with 2 cores and 4GB each, but in this case it is recommended to only run up to two processes per machine - i.e. DataNode and TabletServer or DataNode and MapReduce worker but not all three. The constraint here is having enough available heap space for all the processes on a machine.</p>

<h2 id="a-idnetworka-network"><a id="Network"></a> Network</h2>

<p>Accumulo communicates via remote procedure calls over TCP/IP for both passing data and control messages. In addition, Accumulo uses HDFS clients to communicate with HDFS. To achieve good ingest and query performance, sufficient network bandwidth must be available between any two machines.</p>

<h2 id="a-idinstallationa-installation"><a id="Installation"></a> Installation</h2>

<p>Choose a directory for the Accumulo installation. This directory will be referenced by the environment variable $ACCUMULO_HOME. Run the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ tar xzf $ACCUMULO_HOME/accumulo.tar.gz
</code></pre>
</div>

<p>Repeat this step at each machine within the cluster. Usually all machines have the same $ACCUMULO_HOME.</p>

<h2 id="a-iddependenciesa-dependencies"><a id="Dependencies"></a> Dependencies</h2>

<p>Accumulo requires HDFS and ZooKeeper to be configured and running before starting. Password-less SSH should be configured between at least the Accumulo master and TabletServer machines. It is also a good idea to run Network Time Protocol (NTP) within the cluster to ensure nodes’ clocks don’t get too out of sync, which can cause problems with automatically timestamped data. Accumulo will remove from the set of TabletServers those machines whose times differ too much from the master’s.</p>

<h2 id="a-idconfigurationa-configuration"><a id="Configuration"></a> Configuration</h2>

<p>Accumulo is configured by editing several Shell and XML files found in $ACCUMULO_HOME/conf. The structure closely resembles Hadoop’s configuration files.</p>

<h3 id="a-ideditconfaccumulo-envsha-edit-confaccumulo-envsh"><a id="Edit_conf/accumulo-env.sh"></a> Edit conf/accumulo-env.sh</h3>

<p>Accumulo needs to know where to find the software it depends on. Edit accumulo-env.sh and specify the following:</p>

<ol>
  <li>Enter the location of the installation directory of Accumulo for $ACCUMULO_HOME</li>
  <li>Enter your system’s Java home for $JAVA_HOME</li>
  <li>Enter the location of Hadoop for $HADOOP_HOME</li>
  <li>Choose a location for Accumulo logs and enter it for $ACCUMULO_LOG_DIR</li>
  <li>Enter the location of ZooKeeper for $ZOOKEEPER_HOME</li>
</ol>

<p>By default Accumulo TabletServers are set to use 1GB of memory. You may change this by altering the value of $ACCUMULO_TSERVER_OPTS. Note the syntax is that of the Java JVM command line options. This value should be less than the physical memory of the machines running TabletServers.</p>

<p>There are similar options for the master’s memory usage and the garbage collector process. Reduce these if they exceed the physical RAM of your hardware and increase them, within the bounds of the physical RAM, if a process fails because of insufficient memory.</p>

<p>Note that you will be specifying the Java heap space in accumulo-env.sh. You should make sure that the total heap space used for the Accumulo tserver and the Hadoop DataNode and TaskTracker is less than the available memory on each slave node in the cluster. On large clusters, it is recommended that the Accumulo master, Hadoop NameNode, secondary NameNode, and Hadoop JobTracker all be run on separate machines to allow them to use more heap space. If you are running these on the same machine on a small cluster, likewise make sure their heap space settings fit within the available memory.</p>

<h3 id="a-idclusterspecificationa-cluster-specification"><a id="Cluster_Specification"></a> Cluster Specification</h3>

<p>On the machine that will serve as the Accumulo master:</p>

<ol>
  <li>Write the IP address or domain name of the Accumulo Master to the <br />
$ACCUMULO_HOME/conf/masters file.</li>
  <li>Write the IP addresses or domain name of the machines that will be TabletServers in <br />
$ACCUMULO_HOME/conf/slaves, one per line.</li>
</ol>

<p>Note that if using domain names rather than IP addresses, DNS must be configured properly for all machines participating in the cluster. DNS can be a confusing source of errors.</p>

<h3 id="a-idaccumulosettingsa-accumulo-settings"><a id="Accumulo_Settings"></a> Accumulo Settings</h3>

<p>Specify appropriate values for the following settings in <br />
$ACCUMULO_HOME/conf/accumulo-site.xml :</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;property&gt;
    &lt;name&gt;zookeeper&lt;/name&gt;
    &lt;value&gt;zooserver-one:2181,zooserver-two:2181&lt;/value&gt;
    &lt;description&gt;list of zookeeper servers&lt;/description&gt;
&lt;/property&gt;
&lt;property&gt;
    &lt;name&gt;walog&lt;/name&gt;
    &lt;value&gt;/var/accumulo/walogs&lt;/value&gt;
    &lt;description&gt;local directory for write ahead logs&lt;/description&gt;
&lt;/property&gt;
</code></pre>
</div>

<p>This enables Accumulo to find ZooKeeper. Accumulo uses ZooKeeper to coordinate settings between processes and helps finalize TabletServer failure.</p>

<p>Accumulo records all changes to tables to a write-ahead log before committing them to the table. The `walog’ setting specifies the local directory on each machine to which write-ahead logs are written. This directory should exist on all machines acting as TabletServers.</p>

<p>Some settings can be modified via the Accumulo shell and take effect immediately. However, any settings that should be persisted across system restarts must be recorded in the accumulo-site.xml file.</p>

<h3 id="a-iddeployconfigurationa-deploy-configuration"><a id="Deploy_Configuration"></a> Deploy Configuration</h3>

<p>Copy the masters, slaves, accumulo-env.sh, and if necessary, accumulo-site.xml from the <br />
$ACCUMULO_HOME/conf/ directory on the master to all the machines specified in the slaves file.</p>

<h2 id="a-idinitializationa-initialization"><a id="Initialization"></a> Initialization</h2>

<p>Accumulo must be initialized to create the structures it uses internally to locate data across the cluster. HDFS is required to be configured and running before Accumulo can be initialized.</p>

<p>Once HDFS is started, initialization can be performed by executing <br />
$ACCUMULO_HOME/bin/accumulo init . This script will prompt for a name for this instance of Accumulo. The instance name is used to identify a set of tables and instance-specific settings. The script will then write some information into HDFS so Accumulo can start properly.</p>

<p>The initialization script will prompt you to set a root password. Once Accumulo is initialized it can be started.</p>

<h2 id="a-idrunninga-running"><a id="Running"></a> Running</h2>

<h3 id="a-idstartingaccumuloa-starting-accumulo"><a id="Starting_Accumulo"></a> Starting Accumulo</h3>

<p>Make sure Hadoop is configured on all of the machines in the cluster, including access to a shared HDFS instance. Make sure HDFS and ZooKeeper are running. Make sure ZooKeeper is configured and running on at least one machine in the cluster. Start Accumulo using the bin/start-all.sh script.</p>

<p>To verify that Accumulo is running, check the Status page as described under <em>Monitoring</em>. In addition, the Shell can provide some information about the status of tables via reading the !METADATA table.</p>

<h3 id="a-idstoppingaccumuloa-stopping-accumulo"><a id="Stopping_Accumulo"></a> Stopping Accumulo</h3>

<p>To shutdown cleanly, run bin/stop-all.sh and the master will orchestrate the shutdown of all the tablet servers. Shutdown waits for all minor compactions to finish, so it may take some time for particular configurations.</p>

<h3 id="a-idaddinganodea-adding-a-node"><a id="Adding_a_Node"></a> Adding a Node</h3>

<p>Update your $ACCUMULO_HOME/conf/slaves (or $ACCUMULO_CONF_DIR/slaves) file to account for the addition.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ACCUMULO_HOME/bin/accumulo admin start &lt;host(s)&gt; {&lt;host&gt; ...}
</code></pre>
</div>

<p>Alternatively, you can ssh to each of the hosts you want to add and run $ACCUMULO_HOME/bin/start-here.sh.</p>

<p>Make sure the host in question has the new configuration, or else the tablet server won’t start; at a minimum this needs to be on the host(s) being added, but in practice it’s good to ensure consistent configuration across all nodes.</p>

<h3 id="a-iddecomissioninganodea-decomissioning-a-node"><a id="Decomissioning_a_Node"></a> Decomissioning a Node</h3>

<p>If you need to take a node out of operation, you can trigger a graceful shutdown of a tablet server. Accumulo will automatically rebalance the tablets across the available tablet servers.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ACCUMULO_HOME/bin/accumulo admin stop &lt;host(s)&gt; {&lt;host&gt; ...}
</code></pre>
</div>

<p>Alternatively, you can ssh to each of the hosts you want to remove and run $ACCUMULO_HOME/bin/stop-here.sh.</p>

<p>Be sure to update your $ACCUMULO_HOME/conf/slaves (or $ACCUMULO_CONF_DIR/slaves) file to account for the removal of these hosts. Bear in mind that the monitor will not re-read the slaves file automatically, so it will report the decomissioned servers as down; it’s recommended that you restart the monitor so that the node list is up to date.</p>

<h2 id="a-idmonitoringa-monitoring"><a id="Monitoring"></a> Monitoring</h2>

<p>The Accumulo Master provides an interface for monitoring the status and health of Accumulo components. This interface can be accessed by pointing a web browser to <br />
http://accumulomaster:50095/status</p>

<h2 id="a-idlogginga-logging"><a id="Logging"></a> Logging</h2>

<p>Accumulo processes each write to a set of log files. By default these are found under <br />
$ACCUMULO/logs/.</p>

<h2 id="a-idrecoverya-recovery"><a id="Recovery"></a> Recovery</h2>

<p>In the event of TabletServer failure or error on shutting Accumulo down, some mutations may not have been minor compacted to HDFS properly. In this case, Accumulo will automatically reapply such mutations from the write-ahead log either when the tablets from the failed server are reassigned by the Master, in the case of a single TabletServer failure or the next time Accumulo starts, in the event of failure during shutdown.</p>

<p>Recovery is performed by asking the loggers to copy their write-ahead logs into HDFS. As the logs are copied, they are also sorted, so that tablets can easily find their missing updates. The copy/sort status of each file is displayed on Accumulo monitor status page. Once the recovery is complete any tablets involved should return to an ``online” state. Until then those tablets will be unavailable to clients.</p>

<p>The Accumulo client library is configured to retry failed mutations and in many cases clients will be able to continue processing after the recovery process without throwing an exception.</p>

<p>Note that because Accumulo uses timestamps to order mutations, any mutations that are applied as part of the recovery process should appear to have been applied when they originally arrived at the TabletServer that failed. This makes the ordering of mutations consistent in the presence of failure.</p>

<hr />

<p>** Next:** <a href="Shell_Commands.html">Shell Commands</a> ** Up:** <a href="accumulo_user_manual.html">Apache Accumulo User Manual Version 1.4</a> ** Previous:** <a href="Security.html">Security</a>   ** <a href="Contents.html">Contents</a>**</p>


      </div>

      <div id="footer">
        <a href="http://www.apache.org">
          <img id="asf-logo" alt="Apache Software Foundation" src="/images/feather-small.gif" height="100">
        </a>
        <div class="copyright">
          <p>
          Copyright &copy; 2011-2016 The Apache Software Foundation, Licensed under
          the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
          Apache Accumulo, Accumulo, Apache, the Apache feather logo, and the Apache Accumulo
          project logo are trademarks of the <a href="http://www.apache.org">Apache Software Foundation</a>.<br />
          Site created with <a href="http://getbootstrap.com/">Bootstrap</a> including icons from <a href="http://glyphicons.com/">GLYPHICONS</a> and <a href="http://fontawesome.io/">Font Awesome</a>.
          </p>
        </div>
      </div>
    </div>

  </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>
