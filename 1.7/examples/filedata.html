<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/bootstrap-theme.min.css" rel="stylesheet">
<link href="/css/dataTables.bootstrap.css" rel="stylesheet">
<link href="/css/accumulo.css" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<title>File System Archive Example (Data Only)</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.dataTables.min.js"></script>
<script src="/js/dataTables.bootstrap.js"></script>
<script>
  // show location of canonical site if not currently on the canonical site
  $(function() {
    var host = window.location.host;
    if (typeof host !== 'undefined' && host !== 'accumulo.apache.org') {
      $('#non-canonical').show();
    }
  });

  

  $(function() {
    // decorate section headers with anchors
    return $("h2, h3, h4, h5, h6").each(function(i, el) {
      var $el, icon, id;
      $el = $(el);
      id = $el.attr('id');
      icon = '<i class="fa fa-link"></i>';
      if (id) {
        return $el.append($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));
      }
    });
  });

  // configure Google Analytics
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  if (ga.hasOwnProperty('loaded') && ga.loaded === true) {
    ga('create', 'UA-50934829-1', 'apache.org');
    ga('send', 'pageview');
  }
</script>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-items">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Accumulo</a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="nav navbar-nav">
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Project<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_index"><a href="/">Home</a></li>
          <li id="nav_downloads"><a href="/downloads">Downloads</a></li>
          <li id="nav_features"><a href="/notable_features">Features</a></li>
          <li><a href="https://www.apache.org/licenses/LICENSE-2.0"><i class="fa fa-external-link"></i> License</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_getinvolved"><a href="/get_involved">Get Involved</a></li>
          <li id="nav_mailinglists"><a href="/mailing_list">Mailing Lists</a></li>
          <li id="nav_people"><a href="/people">People</a></li>
          <li id="nav_blog"><a href="https://blogs.apache.org/accumulo"><i class="fa fa-external-link"></i> Blog</a></li>
          <li id="nav_projects"><a href="/projects">Community Projects</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Governance</li>
          <li id="nav_bylaws"><a href="/bylaws">Bylaws</a></li>
          <li id="nav_consensusbuilding"><a href="/governance/consensusBuilding">Consensus Building</a></li>
          <li id="nav_lazyconsensus"><a href="/governance/lazyConsensus">Lazy Consensus</a></li>
          <li id="nav_govreleasing"><a href="/governance/releasing">Releasing</a></li>
          <li id="nav_voting"><a href="/governance/voting">Voting</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Development<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Guides</li>
          <li id="nav_source"><a href="/source">Source &amp; Guide</a></li>
          <li id="nav_git"><a href="/git">Git Workflow</a></li>
          <li id="nav_versioning"><a href="/versioning">Versioning</a></li>
          <li id="nav_contrib"><a href="/contrib">Contrib Projects</a></li>
          <li id="nav_rb"><a href="/rb">Review Board</a></li>
          <li id="nav_releasing"><a href="/releasing">Making Releases</a></li>
          <li id="nav_verify_release"><a href="/verifying_releases">Verifying Releases</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Issues</li>
          <li><a href="https://issues.apache.org/jira/browse/ACCUMULO"><i class="fa fa-external-link"></i> JIRA</a></li>
          <li><a href="https://github.com/apache/accumulo/issues"><i class="fa fa-external-link"></i> GitHub</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Builds</li>
          <li><a href="https://builds.apache.org/view/A/view/Accumulo"><i class="fa fa-external-link"></i> Jenkins</a></li>
          <li><a href="https://travis-ci.org/apache/accumulo"><i class="fa fa-external-link"></i> Travis CI</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Release Notes</li>
          <li id="nav_rn_171"><a href="/release_notes/1.7.1">1.7.1</a></li>
          <li id="nav_rn_165"><a href="/release_notes/1.6.5">1.6.5</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Manual</li>
          <li><a href="/1.7/accumulo_user_manual">1.7</a></li>
          <li><a href="/1.6/accumulo_user_manual">1.6</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Javadoc</li>
          <li><a href="/1.7/apidocs">1.7</a></li>
          <li><a href="/1.6/apidocs">1.6</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Examples</li>
          <li id="nav_examples_17"><a href="/1.7/examples">1.7</a></li>
          <li id="nav_examples_16"><a href="/1.6/examples">1.6</a></li>
          <li class="divider"></li>
          <li id="nav_rn"><a href="/release_notes">Release Notes Archive</a></li>
          <li id="old_documentation"><a href="/old_documentation">Docs for Older Verisons</a></li>
          <li id="nav_screenshots"><a href="/screenshots">Screenshots</a></li>
          <li id="nav_papers"><a href="/papers">Papers &amp; Presentations</a></li>
          <li id="nav_glossary"><a href="/glossary">Glossary</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">ASF Links<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="https://www.apache.org"><i class="fa fa-external-link"></i> Apache Software Foundation</a></li>
          <li><a href="https://www.apache.org/foundation/sponsorship"><i class="fa fa-external-link"></i> Sponsorship</a></li>
          <li><a href="https://www.apache.org/security"><i class="fa fa-external-link"></i> Security</a></li>
          <li><a href="https://www.apache.org/foundation/thanks"><i class="fa fa-external-link"></i> Thanks</a></li>
          <li><a href="https://www.apache.org/foundation/policies/conduct"><i class="fa fa-external-link"></i> Code of Conduct</a></li>
        </ul>
        </li>
      </ul>
      <form method="GET" action="http://search-hadoop.com" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" name="q" class="form-control" placeholder="Search"/>
          <input type="hidden" name="fc_project" value="Accumulo"/>
        </div>
        <button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
      </form>
    </div>
  </div>
</nav>


<div class="container-fluid">
  <div class="row">
    <div class="col-md-2" id="sidebar">
      <div style="text-align: center">
        <a href="/"><img id="logo" alt="Apache Accumulo &trade;" class="img-responsive" src="/images/accumulo-logo.png"/></a>
        <br />
        Latest 1.7 release: <strong>1.7.1</strong><br />
        Latest 1.6 release: <strong>1.6.5</strong><br />
        <br>
        <a id="download-button-sidebar" class="btn btn-success btn-block" href="/downloads/" role="button">Download</a>
      </div>
      <hr>
      
<table class="table" id="sociallinks">
  <tbody>
    <tr>
      <td><img src="/images/Twitter_logo_blue.png" alt="Twitter" style="height: 1em" /></td>
      <td><a href="https://twitter.com/apacheaccumulo">@ApacheAccumulo</a></td>
    </tr>
    <tr>
      <td><img src="/images/InBug-16px_0.png" alt="Linked in" /></td>
      <td><a href="https://www.linkedin.com/groups/Apache-Accumulo-Professionals-4554913">Apache Accumulo Professionals</a></td>
    </tr>
    <tr>
      <td><img src="/images/GitHub-Mark-32px.png" alt="GitHub" style="height: 1em" /></td>
      <td><a href="https://github.com/apache/accumulo">apache / accumulo</a></td>
    </tr>
    <tr>
      <td><span class="glyphicon glyphicon-comment"></span></td>
      <td><a href="irc://chat.freenode.net/accumulo">#accumulo @ freenode</a></td>
    </tr>
    <tr>
      <td><img src="/favicon.png" alt="Blog" width="16" /></td>
      <td><a href="https://blogs.apache.org/accumulo">Apache Accumulo Blog</a></td>
    </tr>
  </tbody>
</table>



      <hr>
      <a id="accumulo-summit-logo" href="http://accumulosummit.com/"><img alt="Accumulo Summit" class="img-responsive" src="/images/accumulo-summit.png"></a>
    </div>
    <div class="col-md-8 col-md-offset-1">

      <div id="non-canonical" style="display: none; background-color: #F0E68C; padding-left: 1em;">
        Visit the official site at: <a href="https://accumulo.apache.org">https://accumulo.apache.org</a>
      </div>
      <div id="content">
        
        <h1 class="title">File System Archive Example (Data Only)</h1>
        
        <p>This example archives file data into an Accumulo table. Files with duplicate data are only stored once.
The example has the following classes:</p>

<ul>
  <li>CharacterHistogram - A MapReduce that computes a histogram of byte frequency for each file and stores the histogram alongside the file data. An example use of the ChunkInputFormat.</li>
  <li>ChunkCombiner - An Iterator that dedupes file data and sets their visibilities to a combined visibility based on current references to the file data.</li>
  <li>ChunkInputFormat - An Accumulo InputFormat that provides keys containing file info (List&lt;Entry&lt;Key,Value») and values with an InputStream over the file (ChunkInputStream).</li>
  <li>ChunkInputStream - An input stream over file data stored in Accumulo.</li>
  <li>FileDataIngest - Takes a list of files and archives them into Accumulo keyed on hashes of the files.</li>
  <li>FileDataQuery - Retrieves file data based on the hash of the file. (Used by the dirlist.Viewer.)</li>
  <li>KeyUtil - A utility for creating and parsing null-byte separated strings into/from Text objects.</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>VisibilityCombiner - A utility for merging visibilities into the form (VIS1)</td>
          <td>(VIS2)</td>
          <td>…</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p>This example is coupled with the dirlist example. See README.dirlist for instructions.</p>

<p>If you haven’t already run the README.dirlist example, ingest a file with FileDataIngest.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./bin/accumulo org.apache.accumulo.examples.simple.filedata.FileDataIngest -i instance -z zookeepers -u username -p password -t dataTable --auths exampleVis --chunk 1000 $ACCUMULO_HOME/README
</code></pre>
</div>

<p>Open the accumulo shell and look at the data. The row is the MD5 hash of the file, which you can verify by running a command such as ‘md5sum’ on the file.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; scan -t dataTable
</code></pre>
</div>

<p>Run the CharacterHistogram MapReduce to add some information about the file.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ bin/tool.sh lib/accumulo-examples-simple.jar org.apache.accumulo.examples.simple.filedata.CharacterHistogram -i instance -z zookeepers -u username -p password -t dataTable --auths exampleVis --vis exampleVis
</code></pre>
</div>

<p>Scan again to see the histogram stored in the ‘info’ column family.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; scan -t dataTable
</code></pre>
</div>

      </div>

      
<footer>

  <p><a href="https://www.apache.org"><img src="/images/feather-small.gif" alt="Apache Software Foundation" id="asf-logo" height="100" /></a></p>

  <p>Copyright © 2011-2016 The Apache Software
Foundation, Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>. Apache
Accumulo, Accumulo, Apache Hadoop, Apache HBase, Apache Cassandra,
Apache Thrift, Apache, the Apache feather logo, and the Apache Accumulo project
logo are trademarks of the <a href="https://www.apache.org">Apache Software Foundation</a>.</p>

  <p>Site created with <a href="https://getbootstrap.com">Bootstrap</a> including icons from
<a href="https://glyphicons.com">GLYPHICONS</a> and <a href="http://fontawesome.io">Font Awesome</a>.</p>

</footer>


    </div>

  </div>
</div>

</body>
</html>
