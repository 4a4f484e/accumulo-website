<!DOCTYPE html>
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/bootstrap-theme.min.css" rel="stylesheet">
<link href="/css/dataTables.bootstrap.css" rel="stylesheet">
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.dataTables.min.js"></script>
<script src="/js/dataTables.bootstrap.js"></script>
<link href="/css/accumulo.css" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<title>User Manual: Analytics</title>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

if (ga.hasOwnProperty('loaded') && ga.loaded === true) {
  ga('create', 'UA-50934829-1', 'apache.org');
  ga('send', 'pageview');
}
</script>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-items">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/index.html">Accumulo</a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-items">
      <ul class="nav navbar-nav">
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Project<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_index"><a href="/">Home</a></li>
          <li id="nav_downloads"><a href="/downloads/">Downloads</a></li>
          <li id="nav_features"><a href="/notable_features.html">Features</a></li>
          <li><a href="http://www.apache.org/licenses/LICENSE-2.0"><i class="fa fa-external-link"></i> License</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_getinvolved"><a href="/get_involved.html">Get Involved</a></li>
          <li id="nav_mailinglists"><a href="/mailing_list.html">Mailing Lists</a></li>
          <li id="nav_people"><a href="/people.html">People</a></li>
          <li id="nav_blog"><a href="https://blogs.apache.org/accumulo/">Blog</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Governance</li>
          <li id="nav_bylaws"><a href="/bylaws.html">Bylaws</a></li>
          <li id="nav_consensusbuilding"><a href="/governance/consensusBuilding.html">Consensus Building</a></li>
          <li id="nav_lazyconsensus"><a href="/governance/lazyConsensus.html">Lazy Consensus</a></li>
          <li id="nav_releasing"><a href="/governance/releasing.html">Releasing</a></li>
          <li id="nav_voting"><a href="/governance/voting.html">Voting</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Development<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li id="nav_source"><a href="/source.html">Source &amp; Guide</a></li>
          <li id="nav_git"><a href="/git.html">Git Workflow</a></li>
          <li id="nav_versioning"><a href="/versioning.html">Versioning</a></li>
          <li id="nav_contrib"><a href="/contrib.html">Contrib Projects</a></li>
          <li id="nav_rb"><a href="/rb.html">Review Board</a></li>
          <li id="nav_releasing"><a href="/releasing.html">Making Releases</a></li>
          <li id="nav_verify_release"><a href="/verifying_releases.html">Verifying Releases</a></li>
          <li><a href="https://issues.apache.org/jira/browse/accumulo"><i class="fa fa-external-link"></i> Issues</a></li>
          <li><a href="https://builds.apache.org/view/A-D/view/Accumulo/"><i class="fa fa-external-link"></i> Builds</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Manual</li>
          <li><a href="/1.6/accumulo_user_manual.html">1.6</a></li>
          <li><a href="/1.7/accumulo_user_manual.html">1.7</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Javadoc</li>
          <li><a href="/1.6/apidocs">1.6</a></li>
          <li><a href="/1.7/apidocs">1.7</a></li>
          <li class="divider"></li>
          <li class="dropdown-header">Examples</li>
          <li id="nav_examples_1_6"><a href="/1.6/examples">1.6</a></li>
          <li id="nav_examples_1_7"><a href="/1.7/examples">1.7</a></li>
          <li class="divider"></li>
          <li id="old_documentation"><a href="/old_documentation.html">Docs for Older Verisons</a></li>
          <li id="nav_screenshots"><a href="/screenshots.html">Screenshots</a></li>
          <li id="nav_papers"><a href="/papers.html">Papers &amp; Other Links</a></li>
          <li id="nav_glossary"><a href="/glossary.html">Glossary</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Release Notes<span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="/release_notes/1.7.1.html">1.7.1</a></li>
          <li><a href="/release_notes/1.6.5.html">1.6.5</a></li>
          <li class="divider"></li>
          <li><a href="/release_notes/">Archives</a></li>
        </ul>
        </li>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Other<span class="caret" /></a>
          <ul class="dropdown-menu">
            <li><a href="/papers.html">Papers &amp; Presentations</a></li>
            <li><a href="/projects.html">Community Projects</a></li>
          </ul>
          </li>
          <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">ASF Links<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="http://www.apache.org"><i class="fa fa-external-link"></i> Apache Software Foundation</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html"><i class="fa fa-external-link"></i> Sponsorship</a></li>
            <li><a href="http://www.apache.org/security/"><i class="fa fa-external-link"></i> Security</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html"><i class="fa fa-external-link"></i> Thanks</a></li>
            <li><a href="http://www.apache.org/foundation/policies/conduct.html"><i class="fa fa-external-link"></i> Code of Conduct</a></li>
          </ul>
          </li>
        </ul>
        <form method="GET" action="http://search-hadoop.com/" class="navbar-form navbar-right" role="search">
          <div class="form-group">
            <input type="text" name="q" class="form-control" placeholder="Search"/>
            <input type="hidden" name="fc_project" value="Accumulo"/>
          </div>
          <button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
        </form>
      </div>
    </div>
  </nav>


<div class="container-fluid">
  <div class="row">
    <div class="col-md-2" id="sidebar">
      <div style="text-align: center">
        <a href="/"><img id="logo" alt="Apache Accumulo &trade;" class="img-responsive" src="/images/accumulo-logo.png"/></a>
        <br />
        Latest 1.7 release: <strong>1.7.1</strong><br />
        Latest 1.6 release: <strong>1.6.5</strong><br />
        <br>
        <a id="download-button-sidebar" class="btn btn-success btn-block" href="/downloads/" role="button">Download</a>
      </div>
      <hr>
      <table class="table" id="sociallinks">
        <tr><td><img src="/images/Twitter_logo_blue.png" style="height: 1em"></td><td><a href="https://twitter.com/apacheaccumulo">@ApacheAccumulo</a></td></tr>
        <tr><td><img src="/images/InBug-16px_0.png"></td><td><a href="https://www.linkedin.com/groups/Apache-Accumulo-Professionals-4554913">Apache Accumulo Professionals</a></td></tr>
        <tr><td><img src="/images/GitHub-Mark-32px.png" style="height: 1em"></td><td><a href="https://github.com/apache/accumulo">apache / accumulo</a></td></tr>
        <tr><td><span class="glyphicon glyphicon-comment"></span></td><td><a href="irc://chat.freenode.net/accumulo">#accumulo @ freenode</a></td></tr>
        <tr><td><img src="/favicon.png" width="16" /></td><td><a href="http://blogs.apache.org/accumulo">Apache Accumulo Blog</a></td></tr>
      </table>
      <hr>
      <a id="accumulo-summit-logo" href="http://accumulosummit.com/"><img alt="Accumulo Summit" class="img-responsive" src="/images/accumulo-summit.png"></a>
    </div>
    <div class="col-md-8 col-md-offset-1">

      <div id="content">
        
        <h1 class="title">User Manual: Analytics</h1>
        
        <p>** Next:** <a href="Security.html">Security</a> ** Up:** <a href="accumulo_user_manual.html">Apache Accumulo User Manual Version 1.3</a> ** Previous:** <a href="High_Speed_Ingest.html">High-Speed Ingest</a>   ** <a href="Contents.html">Contents</a>**</p>

<p><a id="CHILD_LINKS"></a><strong>Subsections</strong></p>

<ul>
  <li><a href="Analytics.html#MapReduce">MapReduce</a></li>
  <li><a href="Analytics.html#Aggregating_Iterators">Aggregating Iterators</a></li>
  <li><a href="Analytics.html#Statistical_Modeling">Statistical Modeling</a></li>
</ul>

<hr />

<h2 id="a-idanalyticsa-analytics"><a id="Analytics"></a> Analytics</h2>

<p>Accumulo supports more advanced data processing than simply keeping keys sorted and performing efficient lookups. Analytics can be developed by using MapReduce and Iterators in conjunction with Accumulo tables.</p>

<h2 id="a-idmapreducea-mapreduce"><a id="MapReduce"></a> MapReduce</h2>

<p>Accumulo tables can be used as the source and destination of MapReduce jobs. To use an Accumulo table with a MapReduce job (specifically with the new Hadoop API as of version 0.20), configure the job parameters to use the AccumuloInputFormat and AccumuloOutputFormat. Accumulo specific parameters can be set via these two format classes to do the following:</p>

<ul>
  <li>Authenticate and provide user credentials for the input</li>
  <li>Restrict the scan to a range of rows</li>
  <li>Restrict the input to a subset of available columns</li>
</ul>

<h3 id="a-idmapperandreducerclassesa-mapper-and-reducer-classes"><a id="Mapper_and_Reducer_classes"></a> Mapper and Reducer classes</h3>

<p>To read from an Accumulo table create a Mapper with the following class parameterization and be sure to configure the AccumuloInputFormat.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class MyMapper extends Mapper&lt;Key,Value,WritableComparable,Writable&gt; {
    public void map(Key k, Value v, Context c) {
        // transform key and value data here
    }
}
</code></pre>
</div>

<p>To write to an Accumulo table, create a Reducer with the following class parameterization and be sure to configure the AccumuloOutputFormat. The key emitted from the Reducer identifies the table to which the mutation is sent. This allows a single Reducer to write to more than one table if desired. A default table can be configured using the AccumuloOutputFormat, in which case the output table name does not have to be passed to the Context object within the Reducer.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class MyReducer extends Reducer&lt;WritableComparable, Writable, Text, Mutation&gt; {

    public void reduce(WritableComparable key, Iterator&lt;Text&gt; values, Context c) {
        
        Mutation m;
        
        // create the mutation based on input key and value
        
        c.write(new Text("output-table"), m);
    }
}
</code></pre>
</div>

<p>The Text object passed as the output should contain the name of the table to which this mutation should be applied. The Text can be null in which case the mutation will be applied to the default table name specified in the AccumuloOutputFormat options.</p>

<h3 id="a-idaccumuloinputformatoptionsa-accumuloinputformat-options"><a id="AccumuloInputFormat_options"></a> AccumuloInputFormat options</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>Job job = new Job(getConf());
AccumuloInputFormat.setInputInfo(job,
        "user",
        "passwd".getBytes(),
        "table",
        new Authorizations());

AccumuloInputFormat.setZooKeeperInstance(job, "myinstance",
        "zooserver-one,zooserver-two");
</code></pre>
</div>

<p><strong>Optional settings:</strong></p>

<p>To restrict Accumulo to a set of row ranges:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ArrayList&lt;Range&gt; ranges = new ArrayList&lt;Range&gt;();
// populate array list of row ranges ...
AccumuloInputFormat.setRanges(job, ranges);
</code></pre>
</div>

<p>To restrict accumulo to a list of columns:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>ArrayList&lt;Pair&lt;Text,Text&gt;&gt; columns = new ArrayList&lt;Pair&lt;Text,Text&gt;&gt;();
// populate list of columns
AccumuloInputFormat.fetchColumns(job, columns);
</code></pre>
</div>

<p>To use a regular expression to match row IDs:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>AccumuloInputFormat.setRegex(job, RegexType.ROW, "^.*");
</code></pre>
</div>

<h3 id="a-idaccumulooutputformatoptionsa-accumulooutputformat-options"><a id="AccumuloOutputFormat_options"></a> AccumuloOutputFormat options</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>boolean createTables = true;
String defaultTable = "mytable";

AccumuloOutputFormat.setOutputInfo(job,
        "user",
        "passwd".getBytes(),
        createTables,
        defaultTable);

AccumuloOutputFormat.setZooKeeperInstance(job, "myinstance",
        "zooserver-one,zooserver-two");
</code></pre>
</div>

<p><strong>Optional Settings:</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>AccumuloOutputFormat.setMaxLatency(job, 300); // milliseconds
AccumuloOutputFormat.setMaxMutationBufferSize(job, 5000000); // bytes
</code></pre>
</div>

<p>An example of using MapReduce with Accumulo can be found at <br />
accumulo/docs/examples/README.mapred</p>

<h2 id="a-idaggregatingiteratorsa-aggregating-iterators"><a id="Aggregating_Iterators"></a> Aggregating Iterators</h2>

<p>Many applications can benefit from the ability to aggregate values across common keys. This can be done via aggregating iterators and is similar to the Reduce step in MapReduce. This provides the ability to define online, incrementally updated analytics without the overhead or latency associated with batch-oriented MapReduce jobs.</p>

<p>All that is needed to aggregate values of a table is to identify the fields over which values will be grouped, insert mutations with those fields as the key, and configure the table with an aggregating iterator that supports the summarization operation desired.</p>

<p>The only restriction on an aggregating iterator is that the aggregator developer should not assume that all values for a given key have been seen, since new mutations can be inserted at anytime. This precludes using the total number of values in the aggregation such as when calculating an average, for example.</p>

<h3 id="a-idfeaturevectorsa-feature-vectors"><a id="Feature_Vectors"></a> Feature Vectors</h3>

<p>An interesting use of aggregating iterators within an Accumulo table is to store feature vectors for use in machine learning algorithms. For example, many algorithms such as k-means clustering, support vector machines, anomaly detection, etc. use the concept of a feature vector and the calculation of distance metrics to learn a particular model. The columns in an Accumulo table can be used to efficiently store sparse features and their weights to be incrementally updated via the use of an aggregating iterator.</p>

<h2 id="a-idstatisticalmodelinga-statistical-modeling"><a id="Statistical_Modeling"></a> Statistical Modeling</h2>

<p>Statistical models that need to be updated by many machines in parallel could be similarly stored within an Accumulo table. For example, a MapReduce job that is iteratively updating a global statistical model could have each map or reduce worker reference the parts of the model to be read and updated through an embedded Accumulo client.</p>

<p>Using Accumulo this way enables efficient and fast lookups and updates of small pieces of information in a random access pattern, which is complementary to MapReduce’s sequential access model.</p>

<hr />

<p>** Next:** <a href="Security.html">Security</a> ** Up:** <a href="accumulo_user_manual.html">Apache Accumulo User Manual Version 1.3</a> ** Previous:** <a href="High_Speed_Ingest.html">High-Speed Ingest</a>   ** <a href="Contents.html">Contents</a>**</p>


      </div>

      <div id="footer">
        <a alt="Apache Software Foundation" href="http://www.apache.org">
          <img id="asf-logo" alt="Apache Software Foundation" src="/images/feather-small.gif" height="100">
        </a>
        <div class="copyright">
          <p>
          Copyright &copy; 2011-2016 The Apache Software Foundation, Licensed under
          the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
          Apache Accumulo, Accumulo, Apache, the Apache feather logo, and the Apache Accumulo
          project logo are trademarks of the <a href="http://www.apache.org">Apache Software Foundation</a>.<br />
          Site created with <a href="http://getbootstrap.com/">Bootstrap</a> including icons from <a href="http://glyphicons.com/">GLYPHICONS</a> and <a href="http://fontawesome.io/">Font Awesome</a>.
          </p>
        </div>
      </div>
    </div>

  </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>
